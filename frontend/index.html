<!DOCTYPE html>
<!-- Homepage for GameGroup -->
<html style="height:100%; width:100%; margin:0; padding:0;">
<head>
    <title>GameGroup</title>
    <script>
        // Configuration object for Brython modules
        window.CONFIG = {
            BASE_URL: 'http://localhost:8000'
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/brython@3.12.0/brython.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/brython@3.12.0/brython_stdlib.js"></script>
    <link rel="stylesheet" href="main.css">
</head>
<body onload="brython()">
    <script>
        // Poll for auth_token every 5 seconds
        let previousAuthToken = window.localStorage.getItem("auth_token");
        const pollInterval = setInterval(function() {
            const authToken = window.localStorage.getItem("auth_token");
            if (authToken !== previousAuthToken) {
            clearInterval(pollInterval);
            location.reload();
            }
            previousAuthToken = authToken;
        }, 5000);
    </script>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand"><a href="/">GameGroup</a></div>
            <ul class="nav-menu">
                <li><a id="about_nav" href="#about">About</a></li>
                <li><a id="games_nav" href="#games">Games Library</a></li>
                <li><a id="admin_nav" href="#admin">Administration</a></li>
                <li><a id="login_nav" href="#login">Login</a></li>
            </ul>
        </div>
    </nav>
    <section id="login" class="content-section">
        <div class="login-container">
            <h2>Login to GameGroup</h2>
            <p>Enter your email to receive a secure login link</p>
            <form id="login-form">
                <div class="form-group">
                    <label for="email">Email Address:</label>
                    <input type="email" id="email" name="email" required placeholder="your.email@example.com">
                </div>
                <button type="submit" class="submit-btn">Send Login Link</button>
            </form>
            <div id="login-message" class="message"></div>
        </div>
        <div class="logout-container" style="display:none;">
            <h2>You are logged in</h2>
            <div id="user-info"></div>
            <button id="logout-btn" class="submit-btn">Logout</button>
        </div>
    </section>
    <section id="about" class="content-section">
        <h2>About GameGroup</h2>
        <p>GameGroup is a community platform for gamers to connect, share, and enjoy their favorite games together. Our mission is to create a welcoming environment for gamers of all levels.</p>
    </section>
    <section id="games" class="content-section">
        <h2>Games Library</h2>
        <p>Explore our extensive library of games, ranging from classic titles to the latest releases. Join groups, participate in events, and share your gaming experiences with others.</p>
        
        <div id="games-grid-container">
            <div class="games-controls">
                <div class="games-count">
                    <span id="games-count-text">Loading games...</span>
                </div>
                <div class="games-sort">
                    <label for="sort-select">Sort by:</label>
                    <select id="sort-select">
                        <option value="title">Title</option>
                        <option value="">Recently Added</option>
                        <option value="owner">Owner</option>
                        <option value="min_players">Min Players</option>
                        <option value="max_players">Max Players</option>
                        <option value="bgg_rating">BGG Rating</option>
                    </select>
                </div>
            </div>
            
            <div id="games-grid" class="games-grid">
                <p>Loading games...</p>
            </div>
            
            <div id="games-pagination" class="pagination">
                <!-- Pagination controls will be added dynamically -->
            </div>
        </div>
        
        <div id="add-game-container" class="add-game-section" style="display:none;">
            <h3>Add Game Manually</h3>
            <p>Add a single game to the library by filling out the form below.</p>
            <form id="add-game-form">
                <div class="form-group">
                    <label for="game-title">Title: *</label>
                    <input type="text" id="game-title" name="title" required placeholder="Game title">
                </div>
                <div class="form-group">
                    <label for="game-owner">Owner: *</label>
                    <input type="text" id="game-owner" name="owner" required placeholder="Owner name">
                </div>
                <div class="form-group">
                    <label for="game-min-players">Minimum Players: *</label>
                    <input type="number" id="game-min-players" name="min_players" required min="1" placeholder="1">
                </div>
                <div class="form-group">
                    <label for="game-max-players">Maximum Players: *</label>
                    <input type="number" id="game-max-players" name="max_players" required min="1" placeholder="4">
                </div>
                <div class="form-group">
                    <label for="game-bgg-rating">BGG Rating:</label>
                    <input type="number" id="game-bgg-rating" name="bgg_rating" step="0.01" min="0" max="10" placeholder="7.5">
                </div>
                <button type="submit" class="submit-btn">Add Game</button>
            </form>
            <div id="add-game-message" class="message"></div>
        </div>

        <div id="csv-upload-container" class="csv-upload-section" style="display:none;">
            <h3>Import Games from CSV</h3>
            <p>Upload a CSV file to bulk import games. Required columns: title, owner, min_players, max_players</p>
            <form id="csv-upload-form">
                <div class="form-group">
                    <label for="csv-file">Select CSV File:</label>
                    <input type="file" id="csv-file" name="csv-file" accept=".csv" required>
                </div>
                <button type="submit" class="submit-btn">Upload CSV</button>
            </form>
            <div id="csv-upload-message" class="message"></div>
        </div>
    </section>
    <section id="admin" class="content-section">
        <h2>Administration</h2>
        <p>Manage your account settings, group memberships, and event participation through our user-friendly administration panel.</p>
        
        <div class="admin-panel">
            <h3>System Users</h3>
            <div id="users-list-container">
                <p>Loading users...</p>
            </div>
        </div>
    </section>

    <script type="text/python" src="app.py"></script>

    <footer>
        <p>&copy; 2025 GameGroup. All rights reserved.</p>
        <p>
            <a href="mailto:contact@gamegroup.com">Contact Us</a> |
            <a href="https://github.com/gamegroup">GitHub</a>
        </p>
    </footer>
</body>
</html>
